# The working data were derived from MacDougald_macdouga_RS2_rtagett_HI-2312
# Note: The BAM files were actually from HISAT2 tests on this dataset
#
# Focus on three genes gapdh, gapdhs, and egfr (arbitrary) and pull the reads
# that intersect (first we confirmed that gapdh and egfr actually had reads for
# this gene sample). Final downsamplimng is nice because it makes the BAM small
# and we really don't need that many reads.
#
# Note that for testing purposes, sampleA and sampleB are simply different
# downsamples of the excerpted Sample_107012.bam.

egrep 'Gapdh|Gapdhs|Egfr' original.gtf > focused.gtf
module load samtools bedtools
bedtools intersect -a Sample_107012.bam -b focused.gtf -wa -u -sorted > sampleA.full.bam
samtools view -s 0.01 -b sampleA.full.bam > sampleA.bam
samtools view -s 0.01 -b sampleA.full.bam > sampleB.bam
