# Example - Alternative references

Some projects may require alternative references. This example outlines a couple of cases of using alternative reference files.

## Background info:

Watermelon_init uses a [file - genome_references.yaml](config/genome_references.yaml), where each genome build entry contains pointers to the following files for each build:

* fasta - a [FASTA formatted](https://zhanglab.ccmb.med.umich.edu/FASTA/) file of the genomic DNA sequence
* gtf - a [GTF formatted](https://ensembl.org/info/website/upload/gff.html) file annotating the features (e.g. genes or transcripts).
* annotation_tsv - a tab-separated value file relating unique IDs from the GTF, to gene symbols, entrezgene IDs, and descriptions.

With the user's selection of a genome build, watermelon_init inserts the selected genome build information into the configuration file that is generated for the project.

Using alternative references is largely a matter of altering the above reference files in the generated config, and in some cases generating an appropriate annotation_tsv file.

## Details on using alternative references

The following organisms have ENSEMBL references already set up in the default `/nfs/turbo/umms-brcfpipeline/references` location:

Human, mouse, rat, zebrafish, C. elegans, and D. melanogaster

If a different organism is desired, then you'll have to acquire/create the appropriate reference files. The fasta and GTF can usually be downloaded (e.g. [from ENSEMBL](https://ensembl.org/info/data/ftp/index.html)), but the annotation_tsv will likely have to be generated by you. [Here's an example](doc/generating_annotation_tsv.md) using BiomaRt to generate the annotation_tsv table.

Another tip is to use the convenience genome build option `Other` when calling watermelon_init. This contains fake paths that of course must be replaced (e.g. `/path/to/genome.fasta`), but it also generates a config without fastq_screen parameters, thereby skipping that portion of the pipeline (since it would not work with a non-listed organism).



Example of workflow:

    #Run watermelon_init (Note use of genome_build 'Other')
    watermelon_init --genome_build Other --job_suffix _20190824 --sample_sheet samplesheet.csv /path/to/Run_2250

    #Modify the references in the generated config so that they point to the paths of the acquired/generated reference files
    nano config_20190824.yaml

    #Run the pipeline as you normally would
    # Singularity must be available to snakemake, for environment management under the hood
    module load singularity/3.5.2
    snakemake --configfile config_20190824.yaml --snakefile Watermelon/rnaseq.snakefile --profile Watermelon/config/profile-comp5-6
